<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
    <link rel="icon " type = "image/x-icon" href="img/icon.png"/>
    <!-- CSS  -->
    <link href="css/fonts.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="css/semantic.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.8/components/icon.min.css'>

</head>
<script   src="https://code.jquery.com/jquery-3.1.0.js"   integrity="sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk="   crossorigin="anonymous"></script>
<style>
body{
  height:100%; 
  background-color:#f44336;  
  font-family:roboto !important;
  color:white;
}
#textarea{


    overflow: auto;
    outline: none;
    padding:3%;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    border-color: rgba(255, 255, 255, 255);
    border-radius: 10px;
    background-color: rgba(255, 255, 255, 0);
    height:40%;
    width:100%;
    resize: none;
}
</style>
  <body>

<!---MainPage-->

<div id="mainPage" class="ui container basic segment" >
  
     <h1 class="header inverted thin " style="text-align:center; color:white; top:10%; width:100%;font-size:10vw; margin:0px;">Simpleton</h1> 
     <div class="ui search basic segment center aligned">
      <div class="ui icon input transparent inverted " id="searchBox">
        <input    id="search" type="text" placeholder="Enter your Key">
        <i class="search icon "></i>
      </div>
      
    </div>
    <div id="results"></div>
</div>




<div id ="footer" class="container basic segment ui">
  <div class="ui divider inverted"></div>
  <h5 class="ui  header center aligned" style="color:white;">Made with<a class="ui red circular label">Love</a> by  <a href="http://www.lucolsthoorn.com">Luc Olsthoorn</a></h5>
  
</div>


<!--JS -->
<script>
$(document).ready(function(){
  $("#search").focus();
});

  function dispAddNoteButton(key){
        $("#results").append(`<h3 style="text-align:center;" class="header inverted thin "><b>Cant find '${key}'</b>:<i> smash that enter button to add a note to this key</i><h3>`);
        $("body").css('background-color','#f44336');
        var element = $('<i id="addNew" class="add icon link"></i>');
        $("#searchBox").append(element);    
        $('#addNew').click(function(){
          dispAddNoteBox();
        });
  }
  function dispAddNoteBox(key){
    $("body").css('background-color','#673ab7');

          $("#results").empty();
          
          $("#results").append(`<h3 class="header inverted thin ">Enter in your note<h3>`);
          $("#results").append(`<div class="ui search basic segment center aligned">
                <div class="ui icon input transparent inverted " style="width:100%;" id="textBox">
          <textarea id="textArea" ></textarea>
          
          </div>
          </div>`);

          $("#results").append(`<h3 style="text-align:center;" class="header inverted thin "><i> Smash that enter button to add this note (Shift enter if you want a new line)</i><h3>`);
          setTimeout(function(){
            $("#textArea").focus();
            $( "#textArea" ).keydown(function(e) {
              if(e.keyCode == 13 && !e.shiftKey){
                var note = $("#textArea").val();
                $("body").append(`<div style ="width: 100%; position:absolute; top:0px;" class="ui black tiny progress" id="progressBar">
                  <div class="bar"></div>
                 
                </div>`);
                makeRequest(key, note, function(){
                  $('#progressBar').progress({
                    percent: 100
                  });
                  setTimeout(function(){
                    $('#progressBar').remove();
                  },500);
                  $("#results").empty();
                  dispFound(note);
                  $("#search").focus();
                });
                
              }

              if(e.keyCode == 8){
                var note = $("#textArea").val();
                if(note==""){
                  $("#results").empty();

                  dispAddNoteButton(key);
                  $("#search").focus();
                }
              }

            });
          },10);

          

  }
  function makeRequest(key, Note, callback){
    $("#textBox").addClass("disabled field");
    setTimeout(function(){
      callback();
    },1000);
  }
  function dispNotFound(key){
    $("body").css('background-color','#f44336');
    $("#searchBox > i").remove();
    if(key==""){
      $("#searchBox").append('<i class="search icon"></i>');
    }else{
        dispAddNoteButton(key);
    }
  }
  function dispFound(note){
    $("body").css('background-color','#4caf50');
    $("#results").append(note);
    console.log(notex);
  }
  $( "#search" ).keydown(function(e) {
    
    //delay in place so char can be read in
    setTimeout(function(){
        var key = $( "#search" ).val();
        if(e.keyCode == 13){
           dispAddNoteBox(key);
        }else{
        console.log(key);
        var x = serverRequest(key);
        $("#results").empty();
        if(x){
          dispFound(x);
        }else{
          dispNotFound(key);
        }
      }
      }, 20);
      
    });
  //Make request
  function serverRequest(key){
    if(key=="bob"){
      return "yes hello friend";  
    }else {
      return false;
    }
  }

</script>
<script src="js/semantic.js"></script>

</body>
</html>